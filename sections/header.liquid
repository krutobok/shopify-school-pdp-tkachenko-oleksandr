<header
  class="relative z-50 bg-background py-4 md:py-[30px] border-b border-border"
  data-section-id="{{ section.id }}"
>
  <div class="container-fluid flex items-center justify-between">
    <button
      id="MobileMenuToggle"
      class="flex flex-col gap-1 w-6 h-6 justify-center items-center md:hidden order-1 cursor-pointer"
      aria-label="Open menu"
      aria-expanded="false"
      aria-controls="mobile-menu-list"
    >
      <span class="block w-[18px] h-0.5 bg-foreground transition-transform duration-300 origin-center"></span>
      <span class="block w-[18px] h-0.5 bg-foreground transition-opacity duration-300"></span>
      <span class="block w-[18px] h-0.5 bg-foreground transition-transform duration-300 origin-center"></span>
    </button>

    <div class="hidden md:block md:order-0">
      <a href="{{ routes.root_url }}" class="block">
        {% if section.settings.logo != blank %}
          {% assign image_size = section.settings.logo_width | append: 'x' %}
          <img
            src="{{ section.settings.logo | image_url: width: image_size }}"
            alt="{{ shop.name }}"
            width="{{ section.settings.logo_width }}"
            height="{{ section.settings.logo.height }}"
            loading="eager"
            class="object-contain"
          >
        {% else %}
          <span class="text-h2">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>

    <nav class="hidden md:flex gap-8" aria-label="Main navigation">
      <ul class="flex gap-8">
        {% for link in section.settings.menu.links %}
          <li>
            <a
              href="{{ link.url }}"
              class="body-large link-animated text-foreground transition-colors hover:text-gray-dark"
              {% if link.active %}
                aria-current="page"
              {% endif %}
            >
              {{ link.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </nav>

    <div class="order-2 md:order-0 flex items-center">
      <a href="{{ routes.cart_url }}" class="relative group" aria-label="Cart">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6 text-foreground group-hover:text-gray-dark transition-colors"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
        </svg>
        {% if cart.item_count > 0 %}
          <span class="absolute -top-1 -right-1 bg-black text-white text-[10px] font-bold h-4 w-4 flex items-center justify-center rounded-full">
            {{ cart.item_count }}
          </span>
        {% endif %}
      </a>
    </div>
  </div>
  <div
    id="MobileMenu"
    class="absolute top-full left-0 w-full bg-background border-t border-border overflow-hidden transition-all duration-300 max-h-0 opacity-0 md:hidden"
  >
    <div class="flex flex-col p-4 gap-6">
      <div>
        <a href="{{ routes.root_url }}" class="block">
          {% if section.settings.logo != blank %}
            {% assign image_size = section.settings.logo_width | append: 'x' %}
            <img
              src="{{ section.settings.logo | image_url: width: image_size }}"
              alt="{{ shop.name }}"
              width="{{ section.settings.logo_width }}"
              height="{{ section.settings.logo.height }}"
              loading="lazy"
              class="object-contain"
            >
          {% else %}
            <span class="text-h2">{{ shop.name }}</span>
          {% endif %}
        </a>
      </div>
      <ul class="flex flex-col gap-2">
        {% for link in section.settings.menu.links %}
          <li>
            <a
              href="{{ link.url }}"
              class="body-large block py-2 border-b border-border text-foreground hover:text-gray-dark transition-colors"
            >
              {{ link.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const burger = document.getElementById('MobileMenuToggle');
    const menu = document.getElementById('MobileMenu');
    const spans = burger.querySelectorAll('span');

    burger.addEventListener('click', () => {
      const isExpanded = burger.getAttribute('aria-expanded') === 'true';
      burger.setAttribute('aria-expanded', !isExpanded);

      if (!isExpanded) {
        menu.classList.remove('max-h-0', 'opacity-0');
        menu.classList.add('max-h-screen', 'opacity-100');
        spans[0].classList.add('rotate-45', 'translate-y-[6px]');
        spans[1].classList.add('opacity-0');
        spans[2].classList.add('-rotate-45', '-translate-y-[6px]');
      } else {
        menu.classList.add('max-h-0', 'opacity-0');
        menu.classList.remove('max-h-screen', 'opacity-100');
        spans[0].classList.remove('rotate-45', 'translate-y-[6px]');
        spans[1].classList.remove('opacity-0');
        spans[2].classList.remove('-rotate-45', '-translate-y-[6px]');
      }
    });
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 250,
      "step": 10,
      "default": 100,
      "unit": "px",
      "label": "Logo width"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    }
  ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}
